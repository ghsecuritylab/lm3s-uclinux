LIBTOMCRYPT_DIR   := libtomcrypt-1.17

.PHONY: all

LIBPATH := $(CURDIR)/output/lib
export LIBPATH
INCPATH := $(CURDIR)/output/include
export INCPATH
DATAPATH := $(CURDIR)/output/doc
export DATAPATH
INSTALL_USER := $(shell whoami)
export INSTALL_USER
INSTALL_GROUP := $(shell whoami)
export INSTALL_GROUP

CFLAGS += -DLTC_NO_CIPHERS

ifdef CONFIG_LIB_TOMCRYPT_CIPHER_BLOWFISH
	CFLAGS += -DLTC_BLOWFISH
endif

ifdef CONFIG_LIB_TOMCRYPT_CIPHER_DES
	CFLAGS += -DLTC_DES
endif

ifdef CONFIG_LIB_TOMCRYPT_CIPHER_AES128
	CFLAGS += -DLTC_RIJNDAEL
endif

CFLAGS += -DLTC_NO_MODES

ifdef CONFIG_LIB_TOMCRYPT_MODE_CBC
	CFLAGS += -DLTC_CBC_MODE
endif

CFLAGS += -DLTC_NO_HASHES

ifdef CONFIG_LIB_TOMCRYPT_HASH_MD5
	CFLAGS += -DLTC_SHA1
endif

ifdef CONFIG_LIB_TOMCRYPT_HASH_SHA1
	CFLAGS += -DLTC_MD5
endif

CFLAGS += -DLTC_NO_MACS

CFLAGS += -DLTC_NO_PRNGS

ifdef CONFIG_LIB_TOMCRYPT_PRNG_SYSTEM
	CFLAGS += -DLTC_SPRNG
endif

ifdef CONFIG_LIB_TOMCRYPT_PRNG_DEVRANDOM
	CFLAGS += -DLTC_DEVRANDOM
endif

ifdef CONFIG_LIB_TOMCRYPT_PRNG_URANDOM_FIRST
	CFLAGS += -DTRY_URANDOM_FIRST
endif

CFLAGS += -DLTC_NO_PK

ifdef CONFIG_LIB_TOMCRYPT_PK_RSA
	CFLAGS += -DLTC_MRSA -DLTC_DER
endif

ifdef CONFIG_LIB_TOMCRYPT_PK_DSA
	CFLAGS += -DLTC_MDSA -DLTC_DER
endif

ifdef CONFIG_LIB_TOMCRYPT_PK_ECC
	CFLAGS += -DLTC_MECC -DLTC_ECC_SHAMIR -DLTC_DER
endif

CFLAGS += -DLTC_NO_CURVES

ifdef CONFIG_LIB_TOMCRYPT_ECC_CURVE_SECP160R1
	CFLAGS += -DECC160
endif

CFLAGS += -DLTC_NO_TEST
CFLAGS += -DLTC_NO_PKCS

all:
	$(MAKE) -C $(LIBTOMCRYPT_DIR)
	$(MAKE) -C $(LIBTOMCRYPT_DIR) install

clean:
	$(MAKE) -C $(LIBTOMCRYPT_DIR) clean

romfs:
